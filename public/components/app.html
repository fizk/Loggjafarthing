<link rel="import" href="../vendor/polymer/polymer.html">
<link rel="import" href="../vendor/iron-ajax/iron-ajax.html">
<link rel="import" href="../vendor/iron-icons/iron-icons.html">
<link rel="import" href="../vendor/iron-image/iron-image.html">
<link rel="import" href="../vendor/neon-animation/neon-animated-pages.html">
<link rel="import" href="../vendor/neon-animation/neon-animations.html">
<link rel="import" href="../vendor/neon-animation/neon-animatable.html">
<link rel="import" href="../vendor/neon-animation/neon-shared-element-animatable-behavior.html">
<link rel="import" href="../vendor/paper-spinner/paper-spinner.html">
<link rel="import" href="../vendor/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../vendor/paper-fab/paper-fab.html">
<link rel="import" href="../vendor/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../vendor/paper-button/paper-button.html">
<link rel="import" href="../vendor/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../vendor/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../vendor/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../vendor/paper-item/all-imports.html">

<link rel="import" href="althingi-pagination.html">
<link rel="import" href="althingi-assembly.html">
<link rel="import" href="althingi-plenary.html">
<link rel="import" href="althingi-issue.html">
<link rel="import" href="althingi-congressman.html">
<link rel="import" href="althingi-party.html">
<link rel="import" href="althingi-speech.html">

<link rel="import" href="../vendor/svg-piechart/svg-piechart.html">

<dom-module id="althingi-app">
    <style is="custom-style">
        paper-toolbar {
            --paper-toolbar-background: rgb(0,187,211); /* changes the background to blue*/
        }
        paper-toolbar h1 {
            font-size: 20px;
        }
    </style>
    <template>
        <paper-drawer-panel>
            <paper-header-panel drawer>
                <paper-toolbar></paper-toolbar>
                <div>Menu coming soon...</div>
            </paper-header-panel>
            <paper-header-panel main>
                <paper-toolbar>
                    <paper-icon-button icon="menu"></paper-icon-button>
                    <h1>Al√æingi</h1>
                </paper-toolbar>
                <neon-animated-pages id="pages" selected="0"
                                     entry-animation="fade-in-animation"
                                     exit-animation="slide-left-animation"
                                     on-congressman-get="handleGetCongressman"
                                     on-plenaries-get="handleGetPlenaries"
                                     on-speeches-get="handleGetSpeeches"
                                     on-issues-get="handleGetIssues">
                    <althingi-assembly-list></althingi-assembly-list>
                    <!--althingi-assembly-profile assembly="144"></althingi-assembly-profile-->
                    <althingi-congressman-profile></althingi-congressman-profile>
                    <althingi-issue-list></althingi-issue-list>
                    <althingi-speech-list></althingi-speech-list>
                </neon-animated-pages>
            </paper-header-panel>
        </paper-drawer-panel>
    </template>
    <script>
        Polymer({

            is: 'althingi-app',

            ready: function () {
                page('/', function (ctx, next) {
                    this._getHomePage();
                }.bind(this));

                page("/loggjafarthing/:assembly/thingmal", function (ctx, next) {
                    this._getIssues(ctx.params.assembly);
                }.bind(this));

                page('/loggjafarthing/:assembly/thingmal/:issue/raedur', function (ctx, next) {
                    this._getSpeeches(ctx.params.assembly, ctx.params.issue);
                }.bind(this));

                page("/thingmenn", function (ctx, next) {}.bind(this));

                page("/thingmenn/:congressman", function (ctx, next) {
                    this._getCongressman(ctx.params.congressman);
                }.bind(this));

                page();
            },

            handleGetPlenaries: function (event) {
                var plenaryContainer = document.createElement('althingi-plenaries');
                plenaryContainer.setAttribute('assembly', event.detail.assembly);
                this.$.pages.selected = 2;
                this.$.pages.children[2].innerHTML = '';
                this.$.pages.children[2].appendChild(plenaryContainer);
                this.querySelector('paper-header-panel paper-fab').setAttribute('icon', 'reply');
            },

            handleGetIssues: function (event) {
                page("/loggjafarthing/"+event.detail.assembly+"/thingmal");
                this._getIssues(event.detail.assembly);
            },

            handleGetCongressman: function (event) {
                page('/thingmenn/' + event.detail.congressman);
                this._getCongressman(event.detail.congressman);
            },

            handleGetSpeeches: function (event) {
                page('/loggjafarthing/'+event.detail.assembly+'/thingmal/'+event.detail.issue+'/raedur');
                this._getSpeeches(event.detail.assembly, event.detail.issue);
            },

            _getCongressman: function (id) {
                this.$.pages.selected = 1;
                this.$.pages.children[1].setAttribute('congressman', id);
            },

            _getIssues: function (id) {
                this.$.pages.selected = 2;
                this.$.pages.children[2].setAttribute('assembly', id);
            },

            _getHomePage: function () {
                this.$.pages.selected = 0;
            },

            _getSpeeches: function (assembly, issue) {
                this.$.pages.selected = 3;
                this.$.pages.children[3].setAttribute('assembly', assembly);
                this.$.pages.children[3].setAttribute('issue', issue);
            }
        });
    </script>
</dom-module>
