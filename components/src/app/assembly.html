<link rel="import" href="../../vendor/polymer/polymer.html" />
<link rel="import" href="../../vendor/paper-drawer-panel/paper-drawer-panel.html" />
<link rel="import" href="../../vendor/paper-header-panel/paper-header-panel.html" />
<link rel="import" href="../../vendor/paper-toolbar/paper-toolbar.html" />
<link rel="import" href="../../vendor/neon-animation/neon-animated-pages.html" />
<link rel="import" href="../../vendor/neon-animation/animations/fade-in-animation.html" />
<link rel="import" href="../../vendor/neon-animation/animations/slide-left-animation.html" />

<link rel="import" href="../althingi-assembly/althingi-assembly-list.html" />
<link rel="import" href="../althingi-congressman/althingi-congressman-profile.html" />
<link rel="import" href="../althingi-congressman/althingi-congressman-list.html" />
<link rel="import" href="../althingi-issue/althingi-issue-list.html" />
<link rel="import" href="../althingi-speech/althingi-speech-list.html" />
<link rel="import" href="../althingi-assembly/althingi-assembly-profile.html" />

<!--

-->
<dom-module id="althingi-assembly">
    <link rel="import" type="css" href="assembly.css">
    <script src="../../vendor/page/page.js"></script>
    <template>
        <paper-drawer-panel
                on-congressman-get="handleGetCongressman"
                on-plenaries-get="handleGetPlenaries"
                on-speeches-get="handleGetSpeeches"
                on-assembly-get="handleGetAssembly"
                on-issues-get="handleGetIssues">
            <paper-header-panel drawer>
                <paper-toolbar></paper-toolbar>
                <div>
                    <paper-item on-click="handleGetAssemblies">Thing</paper-item>
                    <paper-item on-click="handleGetCongressmen">Thingmenn</paper-item>
                    <paper-item>Stjornmalaflokkar</paper-item>
                </div>
            </paper-header-panel>
            <paper-header-panel main>
                <paper-toolbar>
                    <paper-icon-button icon="menu"></paper-icon-button>
                    <h1><a href="/">Al√æingi</a></h1>
                </paper-toolbar>
                <neon-animated-pages id="pages" selected="0">
                    <althingi-assembly-list></althingi-assembly-list>
                    <althingi-congressman-profile></althingi-congressman-profile>
                    <althingi-issue-list></althingi-issue-list>
                    <althingi-speech-list></althingi-speech-list>
                    <althingi-assembly-profile></althingi-assembly-profile>
                    <althingi-congressman-list></althingi-congressman-list>
                </neon-animated-pages>
            </paper-header-panel>
        </paper-drawer-panel>
    </template>
    <script>
        Polymer({

            is: 'althingi-assembly',

            ready: function () {
                page('/', function (ctx, next) {
                    this._getAssemblies();
                }.bind(this));

                page("/loggjafarthing/:assembly", function (ctx, next) {
                    this._getAssembly(ctx.params.assembly);
                }.bind(this));

                page("/loggjafarthing/:assembly/thingmal", function (ctx, next) {
                    this._getIssues(ctx.params.assembly);
                }.bind(this));

                page('/loggjafarthing/:assembly/thingmal/:issue/raedur', function (ctx, next) {
                    this._getSpeeches(ctx.params.assembly, ctx.params.issue);
                }.bind(this));

                page("/thingmenn", function (ctx, next) {}.bind(this));

                page("/thingmenn/:congressman", function (ctx, next) {
                    this._getCongressman(ctx.params.congressman);
                }.bind(this));

                page();
            },

            handleGetPlenaries: function (event) {
                var plenaryContainer = document.createElement('althingi-plenaries');
                plenaryContainer.setAttribute('assembly', event.detail.assembly);
                this.$.pages.selected = 2;
                this.$.pages.children[2].innerHTML = '';
                this.$.pages.children[2].appendChild(plenaryContainer);
                //this.querySelector('paper-header-panel paper-fab').setAttribute('icon', 'reply');
            },

            handleGetAssemblies: function () {
                page("/");
                this._getAssemblies();
            },

            handleGetIssues: function (event) {
                page("/loggjafarthing/"+event.detail.assembly+"/thingmal");
                this._getIssues(event.detail.assembly);
            },

            handleGetCongressman: function (event) {
                page('/thingmenn/' + event.detail.congressman);
                this._getCongressman(event.detail.congressman);
            },

            handleGetSpeeches: function (event) {
                page('/loggjafarthing/'+event.detail.assembly+'/thingmal/'+event.detail.issue+'/raedur');
                this._getSpeeches(event.detail.assembly, event.detail.issue);
            },

            handleGetAssembly: function (event) {
                page('/loggjafarthing/'+event.detail.assembly);
                this._getAssembly(event.detail.assembly);
            },

            handleGetCongressmen: function () {
                this.$.pages.selected = 5;
            },

            _getCongressman: function (id) {
                this.$.pages.selected = 1;
                this.$.pages.children[1].setAttribute('congressman', id);
            },

            _getIssues: function (id) {
                this.$.pages.selected = 2;
                this.$.pages.children[2].setAttribute('assembly', id);
            },

            _getAssemblies: function () {
                this.$.pages.selected = 0;
            },

            _getSpeeches: function (assembly, issue) {
                this.$.pages.selected = 3;
                this.$.pages.children[3].setAttribute('assembly', assembly);
                this.$.pages.children[3].setAttribute('issue', issue);
            },

            _getAssembly: function (assembly) {
                this.$.pages.selected = 4;
                this.$.pages.children[4].setAttribute('assembly', assembly);
            }
        });
    </script>
</dom-module>
