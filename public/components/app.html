<link rel="import" href="../vendor/polymer/polymer.html">
<link rel="import" href="../vendor/iron-ajax/iron-ajax.html">
<link rel="import" href="../vendor/paper-button/paper-button.html">
<link rel="import" href="../vendor/paper-fab/paper-fab.html">
<link rel="import" href="../vendor/iron-icons/iron-icons.html">
<link rel="import" href="../vendor/paper-spinner/paper-spinner.html">
<link rel="import" href="../vendor/neon-animation/neon-animated-pages.html">
<link rel="import" href="../vendor/neon-animation/neon-animations.html">
<link rel="import" href="../vendor/neon-animation/neon-animatable.html">
<link rel="import" href="../vendor/neon-animation/neon-shared-element-animatable-behavior.html">
<link rel="import" href="../vendor/iron-image/iron-image.html">
<link rel="import" href="../vendor/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../vendor/paper-icon-button/paper-icon-button.html">

<link rel="import" href="../vendor/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../vendor/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../vendor/paper-toolbar/paper-toolbar.html">

<link rel="import" href="althingi-pagination.html">
<link rel="import" href="althingi-assembly.html">
<link rel="import" href="althingi-plenary.html">
<link rel="import" href="althingi-issue.html">
<link rel="import" href="althingi-congressman.html">
<link rel="import" href="althingi-party.html">
<link rel="import" href="althingi-speech.html">

<dom-module id="althingi-app">
    <template>
        <paper-drawer-panel>
            <paper-header-panel drawer>
                <paper-toolbar></paper-toolbar>
                <div>Menu coming soon...</div>
            </paper-header-panel>
            <paper-header-panel main>
                <paper-toolbar>
                    <paper-fab mini icon="done" on-click="handleNavigateBegin"></paper-fab>
                </paper-toolbar>
                <neon-animated-pages id="pages" selected="0"  entry-animation="fade-in-animation" exit-animation="slide-left-animation"
                                     on-congressman-get="handleGetCongressman"
                                     on-plenaries-get="handleGetPlenaries"
                                     on-speeches-get="handleGetSpeeches"
                                     on-issues-get="handleGetIssues">
                    <div>
                        <althingi-assembly-list></althingi-assembly-list>
                    </div>
                    <div></div>
                    <althingi-congressman-profile></althingi-congressman-profile>
                    <div>
                        <!--althingi-speech-list assembly="144" issue="1"></althingi-speech-list-->
                        <!--althingi-congressman-profile congressman="704"></althingi-congressman-profile-->
                        <!--althingi-congressman-list></althingi-congressman-list-->
                    </div>
                    <div></div>
                    <div></div>
                </neon-animated-pages>
            </paper-header-panel>
        </paper-drawer-panel>



    </template>
    <script>
        (function () {


            Polymer({
                is: 'althingi-app',

                ready: function () {
                    page('/', function (ctx, next) {});

                    page("/thingmenn", function (ctx, next) {}.bind(this));

                    page("/thingmenn/:id", function (ctx, next) {
                        this._getCongressman(ctx.params.id);
                    }.bind(this));

                    page();
                },

                handleGetPlenaries: function (event) {
                    var plenaryContainer = document.createElement('althingi-plenaries');
                    plenaryContainer.setAttribute('assembly', event.detail.assembly);
                    this.$.pages.selected = 2;
                    this.$.pages.children[2].innerHTML = '';
                    this.$.pages.children[2].appendChild(plenaryContainer);
                    this.querySelector('paper-header-panel paper-fab').setAttribute('icon', 'reply');
                },

                handleGetIssues: function (event) {
                    var issueContainer = document.createElement('althingi-issue-list');
                    issueContainer.setAttribute('assembly', event.detail.assembly);
                    this.$.pages.selected = 1;
                    this.$.pages.children[1].innerHTML = '';
                    this.$.pages.children[1].appendChild(issueContainer);

                },

                handleGetCongressman: function (event) {
                    page('/thingmenn/' + event.detail.congressman);
                    this._getCongressman(event.detail.congressman);
                },

                handleGetSpeeches: function (event) {
                    var issueContainer = document.createElement('althingi-speech-list');
                    issueContainer.setAttribute('assembly', event.detail.assembly);
                    issueContainer.setAttribute('issue', event.detail.issue);
                    this.$.pages.selected = 4;
                    this.$.pages.children[4].innerHTML = '';
                    this.$.pages.children[4].appendChild(issueContainer);
                },

                handleNavigateBegin: function (event) {
                    this.$.pages.selected = 0;
                },

                _getCongressman: function (id) {
                    this.$.pages.selected = 2;
                    this.$.pages.children[2].setAttribute('congressman', id);
                }
            });

        })();
    </script>
</dom-module>
